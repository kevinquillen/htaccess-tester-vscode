id: cond-backref
description: Condition backref %1 in substitution
url: "http://old.example.com/page"
rules: |
  RewriteEngine On
  RewriteCond %{HTTP_HOST} ^([^.]+)\.example\.com$
  RewriteRule ^(.*)$ http://example.com/%1/$1 [R=301,L]
serverVariables:
  SERVER_NAME: "old.example.com"
  HTTP_HOST: "old.example.com"
expected:
  outputUrl: "http://example.com/old/page"
  statusCode: 301
  trace:
    - line: "RewriteEngine On"
      reached: true
      met: true
      valid: true
    - line: "RewriteCond %{HTTP_HOST} ^([^.]+)\\.example\\.com$"
      reached: true
      met: true
      valid: true
    - line: "RewriteRule ^(.*)$ http://example.com/%1/$1 [R=301,L]"
      reached: true
      met: true
      valid: true
